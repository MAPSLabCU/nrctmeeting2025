<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <title>Annual NRCT Research Team Meeting 2025</title>
    <link
      rel="icon"
      type="image/png"
      href="img/fav/favicon-96x96.png"
      sizes="96x96"
    />
    <link rel="icon" type="image/svg+xml" href="img/fav/favicon.svg" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="img/fav/apple-touch-icon.png"
    />
    <meta name="apple-mobile-web-app-title" content="MAPS Lab" />
    <link rel="manifest" href="img/fav/site.webmanifest" />
    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />

    <style>
      .section {
        display: none;
      }
      .section.active {
        display: block;
      }
    </style>
    <style>
      body {
        font-family: "Noto Sans", sans-serif;
        padding-top: 60px;
      }
      .hero {
        background: linear-gradient(to right, #9f395a, #ff5c90);
        color: white;
        padding: 80px 0;
        text-align: center;
      }
      .section {
        padding: 60px 0;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand" href="index.html">
          <b>NRCT Research Meeting</b>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <!-- Home with dropdown -->
            <!-- Other menu items -->
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="index.html"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                General Information
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li>
                  <a class="dropdown-item" href="index.html#important_date">
                    Important Date
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" href="index.html#overall_program">
                    Overall Program
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" href="index.html#poster_session">
                    Poster Session
                  </a>
                </li>
              </ul>
            </li>

            <!-- Other menu items -->
            <li class="nav-item">
              <a class="nav-link" href="presentation_guideline.html">
                Information for Presenter
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="registration.html">Registration</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="abstract_submission.html">
                Abstract Submission
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="poster_submission.html">
                Poster Submission
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contact.html">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="container text-center">
        <img
          src="img/logobg.png"
          class="img-fluid"
          style="width: 70%; height: auto"
          alt="Header Image"
        />
        <h1 class="fw-bold">Annual NRCT Research Team Meeting 2025</h1>
        <h4 class="mt-2">
          Functional Dye for Sensing, Catalysis and Phototherapy Applications
        </h4>
        <h3 class="fw-bold text-danger py-2">December 8, 2025</h3>
        <p class="mt-2">
          <i>
            at Faculty of Science,Chulalongkorn University (Phayathai Road),
            Pathumwan, Bangkok, Thailand
          </i>
        </p>
        <hr />
      </div>
      <div class="container mb-3">
        <h4><b>Abstract Submission Guideline</b></h4>
        <ol>
          <li>
            Abstract must be prepared using this
            <a
              href="Abstract_NRCTMeeting2025_Name-Lastname.docx"
              target="_blank"
              download="Abstract_NRCTMeeting2025_Name-Lastname.docx"
            >
              <b>Abstract Template.</b>
            </a>
          </li>
          <li>
            Abstract must be written in English and must not exceed 250 words.
          </li>
          <li>
            Abstract must include up to 5 keywords and may include one graphical
            abstract, but it must not exceed one page.
          </li>
          <li>
            Name your abstract file as
            <font color="#197d00">
              <b>Abstract_NRCTMeeting2025_Name-Lastname.docx</b>
            </font>
          </li>
        </ol>
      </div>
      <div class="container">
        <h4><b>Abstract Submission Form</b></h4>
        <span>
          Please fill in the information and attach the abstract as a Word file
          below.
        </span>
      </div>
      <div class="container py-4 px-3">
        <div
          id="formStatus"
          class="alert text-center fw-bold"
          role="alert"
        ></div>
        <form
          id="abstractForm"
          class="needs-validation"
          novalidate
          style="display: none"
        >
          <!-- Email -->
          <div class="mb-3">
            <label for="email" class="form-label"><strong>Email</strong></label>
            <input
              type="email"
              class="form-control"
              name="Email"
              id="email"
              placeholder="Your Email"
              required
            />
            <div class="invalid-feedback">Please fill your email.</div>
          </div>
          <div class="mb-3">
            <ul>
              <li>
                Please re-check your email before submitting your abstract.
              </li>
            </ul>
          </div>

          <!-- Title -->
          <div class="mb-3">
            <label for="title" class="form-label"><strong>Title</strong></label>
            <select class="form-select" name="Title" id="title" required>
              <option value="" disabled selected>Choose...</option>
              <option>Mr.</option>
              <option>Ms.</option>
              <option>Dr.</option>
            </select>
            <div class="invalid-feedback">Please select your title.</div>
          </div>

          <!-- Name & Surname -->
          <div class="mb-3">
            <label for="name" class="form-label">
              <strong>Full Name (first name and Last name)</strong>
            </label>
            <input
              type="text"
              class="form-control"
              name="Full Name"
              id="name"
              placeholder="Your Full Name"
              required
            />
            <div class="invalid-feedback">
              Please fill your name and surname.
            </div>
          </div>

          <!-- Institution -->
          <div class="mb-3">
            <label for="institution" class="form-label">
              <strong>Institution</strong>
            </label>
            <select
              class="form-select"
              name="Institution"
              id="institution"
              required
            >
              <option value="" disabled selected>Choose...</option>
              <option>Chulalongkorn University</option>
              <option>Thammasat University</option>
              <option>Suranaree University of Technology</option>
              <option>Mahidol University</option>
              <option>King Mongkut's University of Technology Thonburi</option>
            </select>
            <div class="invalid-feedback">Please select your institution.</div>
          </div>

          <!-- File Upload -->
          <div class="mb-3">
            <label for="fileInput" class="form-label">
              <strong>Upload Abstract File</strong>
            </label>
            <input
              class="form-control"
              type="file"
              id="fileInput"
              name="theFile"
              accept=".pdf,.doc,.docx"
              required
            />
            <div class="form-text mt-1" id="fileNameDisplay">
              No file selected
            </div>
            <div class="invalid-feedback">
              Please attach your abstract file.
            </div>
            <input type="hidden" name="filename" id="actualFilename" />
          </div>
          <div class="mb-3">
            <ul>
              <li>
                After your registration has been successfully submitted, please
                check your email for the abstract submission confirmation.
              </li>
              <li>
                If you do not receive the email, please check your junk or spam
                folder first, or try submitting again.
              </li>
              <li>
                If you have any questions, please email the
                <a
                  href="mailto:mapsgroup.floor13@gmail.com"
                  class="text-decoration-none text-primary"
                >
                  meeting coordinators
                </a>
                .
              </li>
            </ul>
          </div>

          <!-- Submit Button -->
          <div class="d-flex">
            <button type="submit" class="btn btn-primary" id="submit-button">
              Submit
            </button>
          </div>
        </form>

        <div id="output" class="mt-4"></div>
      </div>
    </div>
    <br />
    <br />
    <br />
    <footer class="bg-dark text-white text-center py-2 mt-auto">
      <span>For more information, please contact</span>
      <span>
        Mr. Rewat Nakwisai
        <br />
        <i class="fa-solid fa-envelope me-2"></i>
        <a
          href="mailto:mapsgroup.floor13@gmail.com"
          class="text-info"
          style="text-decoration: none"
        >
          mapsgroup.floor13@gmail.com
        </a>
      </span>
      <p class="mb-0">
        &copy; Annual NRCT Research Team Meeting 2025. All rights reserved.
      </p>
    </footer>
    <script>
      // ==== Validation Setup for Bootstrap Form ====
      (function () {
        "use strict";
        var forms = document.querySelectorAll(".needs-validation");

        Array.prototype.slice.call(forms).forEach(function (form) {
          form.addEventListener(
            "submit",
            function (event) {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
                Swal.fire({
                  icon: "warning",
                  title: "Form Incomplete",
                  text: "Please complete all required fields before submitting your abstract.",
                });
              } else {
                event.preventDefault(); // Prevent default submit
                if (form.id === "abstractForm") {
                  handleAbstractSubmit(event);
                }
              }
              form.classList.add("was-validated");
            },
            false
          );
        });
      })();

      // ==== Handle Abstract Submission ====
      async function handleAbstractSubmit(event) {
        const form = event.target;
        const submitButton = form.querySelector('button[type="submit"]');
        const fileInput = form.querySelector("#fileInput");
        const fileNameDisplay = document.getElementById("fileNameDisplay");

        // Show loading SweetAlert
        Swal.fire({
          title: "Submitting Abstract...",
          html: "Uploading your abstract. Please wait.",
          allowOutsideClick: false,
          allowEscapeKey: false,
          didOpen: () => {
            Swal.showLoading();
          },
        });

        submitButton.disabled = true;

        try {
          const formData = new FormData(form);
          const formDataObj = {};

          for (let [key, value] of formData.entries()) {
            formDataObj[key] = value;
          }

          // Convert file to base64
          if (fileInput.files.length > 0) {
            const fileObj = await uploadFile(fileInput.files[0]);
            formDataObj.fileData = fileObj;
          }

          const scriptURL =
            "https://script.google.com/macros/s/AKfycbx3T-0Z75NMPqjfEhLCE1402ijs7XOzTi7E8kIfm4qwKwcAUwRYXYMda3egxG286qBn/exec";
          const response = await fetch(scriptURL, {
            method: "POST",
            body: JSON.stringify(formDataObj),
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          });

          const result = await response.json();

          if (result.status === "success") {
            Swal.fire({
              icon: "success",
              title: "Submission Successful",
              text:
                result.message ||
                "Your abstract has been submitted successfully. Thank you!",
              timer: 3000,
              timerProgressBar: true,
              showConfirmButton: false,
            });
            form.reset();
            fileNameDisplay.textContent = "No file selected";
            form.classList.remove("was-validated");
          } else {
            throw new Error(result.message || "Submission failed");
          }
        } catch (error) {
          console.error("Error:", error);
          Swal.fire({
            icon: "error",
            title: "Submission Failed",
            text:
              error.message ||
              "An unexpected error occurred while submitting your abstract.",
          });
        } finally {
          submitButton.disabled = false;
        }
      }

      // ==== Convert file to base64 ====
      function uploadFile(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const data = e.target.result.split(",");
            resolve({
              fileName: file.name,
              mimeType: data[0].match(/:(\w.+);/)[1],
              data: data[1],
            });
          };
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      // ==== Display selected file name ====
      const fileInput = document.getElementById("fileInput");
      const fileNameDisplay = document.getElementById("fileNameDisplay");

      fileInput.addEventListener("change", function () {
        if (this.files && this.files.length > 0) {
          fileNameDisplay.textContent = this.files[0].name;
        } else {
          fileNameDisplay.textContent = "No file selected";
        }
      });
    </script>
    <script src="js/abstract.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
